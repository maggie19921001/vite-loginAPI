import{u as V,r as k,c as h,a as n,t as g,h as E,w as _,v as f,F as z,i as U,g as l,o as p,j as B,f as F,k as D}from"./index-CqPm2fv2.js";const N={class:"container"},L=n("h3",null,"待辦清單",-1),M={class:"new"},S=n("hr",null,null,-1),j=["onUpdate:modelValue","onClick"],O={key:0},R=["onUpdate:modelValue","onChange"],q=["onClick"],G=["onClick"],H=["onClick"],c="https://todolist-api.hexschool.io",P={__name:"TodoList",setup(I){const i=(()=>{const t=document.cookie.split(";");for(let o of t){const[e,v]=o.trim().split("=");if(e==="loginToken")return v}return null})(),y=V(),C=async()=>{try{const t=await l.post(`${c}/users/sign_out`,{},{headers:{Authorization:i}});y.push("/login")}catch(t){console.log(t.message)}},r=k([]),u=k(""),m={content:""},a=k({}),d=async()=>{const t=await l.get(`${c}/todos`,{headers:{Authorization:i}});console.log(t.data),r.value=t.data.data};d();const x=async()=>{u!=null&&(m.content=u.value),await l.post(`${c}/todos`,m,{headers:{Authorization:i}}),u.value="",d()},$=(t,o)=>{a.value={...a.value,[o]:t.target.value}},b=t=>{const o=r.value.find(e=>e.id===t);o&&(o.isEditing=!o.isEditing,a.value[t]=o.content)},T=async t=>{const o=r.value.find(e=>e.id===t);o.content=a.value[t],await l.put(`${c}/todos/${t}`,o,{headers:{Authorization:i}}),o.isEditing=!1,d(),a.value={...a.value,[t]:""}},w=async t=>{confirm("確定要刪除嗎？")==!0&&(await l.delete(`${c}/todos/${t}`,{headers:{Authorization:i}}),d())},A=async t=>{await l.patch(`${c}/todos/${t}/toggle`,{},{headers:{Authorization:i}}),d()};return(t,o)=>(p(),h("div",N,[n("p",null,"Token: "+g(E(i)),1),n("button",{type:"button",onClick:C},"登出"),L,n("div",M,[_(n("input",{type:"text",placeholder:"to do something","onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e)},null,512),[[f,u.value]]),n("button",{type:"button",onClick:x},"確定")]),S,n("ul",null,[(p(!0),h(z,null,U(r.value,(e,v)=>(p(),h("li",{key:v},[_(n("input",{type:"checkbox","onUpdate:modelValue":s=>e.status=s,onClick:s=>A(e.id)},null,8,j),[[B,e.status]]),F(" "+g(e.content)+" "+g(e.status?"完成":"未完成")+" ",1),e.isEditing?(p(),h("div",O,[_(n("input",{type:"text","onUpdate:modelValue":s=>a.value[e.id]=s,onChange:s=>$(s,e.id)},null,40,R),[[f,a.value[e.id]]]),n("button",{type:"button",onClick:s=>T(e.id)},"確定",8,q)])):D("",!0),n("button",{type:"button",onClick:s=>b(e.id)},"編輯",8,G),n("button",{type:"button",onClick:s=>w(e.id)},"刪除",8,H)]))),128))])]))}};export{P as default};
