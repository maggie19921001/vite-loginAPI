import{u as A,r as _,c as h,a as n,t as k,h as V,w as g,v as f,F as E,i as z,g as c,o as p,j as U,f as B,k as F}from"./index-CWjJeJF4.js";const D={class:"container"},N=n("h3",null,"待辦清單",-1),L={class:"new"},M=n("hr",null,null,-1),j=["onUpdate:modelValue"],O={key:0},R=["onUpdate:modelValue","onChange"],S=["onClick"],q=["onClick"],G=["onClick"],u="https://todolist-api.hexschool.io",K={__name:"TodoList",setup(H){const i=(()=>{const t=document.cookie.split(";");for(let o of t){const[e,v]=o.trim().split("=");if(e==="loginToken")return v}return null})(),y=A(),C=async()=>{try{const t=await c.post(`${u}/users/sign_out`,{},{headers:{Authorization:i}});y.push("/login")}catch(t){console.log(t.message)}},d=_([]),l=_(""),m={content:""},s=_({}),r=async()=>{const t=await c.get(`${u}/todos`,{headers:{Authorization:i}});console.log(t.data),d.value=t.data.data};r();const x=async()=>{l!=null&&(m.content=l.value),await c.post(`${u}/todos`,m,{headers:{Authorization:i}}),l.value="",r()},b=(t,o)=>{s.value={...s.value,[o]:t.target.value}},T=t=>{const o=d.value.find(e=>e.id===t);o&&(o.isEditing=!o.isEditing,s.value[t]=o.content)},$=async t=>{const o=d.value.find(e=>e.id===t);o.content=s.value[t],await c.put(`${u}/todos/${t}`,o,{headers:{Authorization:i}}),o.isEditing=!1,r(),s.value={...s.value,[t]:""}},w=async t=>{confirm("確定要刪除嗎？")==!0&&(await c.delete(`${u}/todos/${t}`,{headers:{Authorization:i}}),r())};return(t,o)=>(p(),h("div",D,[n("p",null,"Token: "+k(V(i)),1),n("button",{type:"button",onClick:C},"登出"),N,n("div",L,[g(n("input",{type:"text",placeholder:"to do something","onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e)},null,512),[[f,l.value]]),n("button",{type:"button",onClick:x},"確定")]),M,n("ul",null,[(p(!0),h(E,null,z(d.value,(e,v)=>(p(),h("li",{key:v},[g(n("input",{type:"checkbox","onUpdate:modelValue":a=>e.status=a},null,8,j),[[U,e.status]]),B(" "+k(e.content)+" "+k(e.status?"完成":"未完成")+" ",1),e.isEditing?(p(),h("div",O,[g(n("input",{type:"text","onUpdate:modelValue":a=>s.value[e.id]=a,onChange:a=>b(a,e.id)},null,40,R),[[f,s.value[e.id]]]),n("button",{type:"button",onClick:a=>$(e.id)},"確定",8,S)])):F("",!0),n("button",{type:"button",onClick:a=>T(e.id)},"編輯",8,q),n("button",{type:"button",onClick:a=>w(e.id)},"刪除",8,G)]))),128))])]))}};export{K as default};
